<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productivity App - Tasks</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .nav-link {
            color: black !important;
            padding: 10px !important;
            text-align: center;
            border-bottom: 1px solid black;
        }
        .nav-link:hover {
            background-color: #e0e0e0 !important;
        }
        .left-side, .right-side {
            height: 100vh;
        }
        .left-side {
            background-color: #f0f0f0;
        }
        .right-side {
            background-color: #ddd;
            padding: 20px;
        }
        .task-item { display: flex; align-items: center; justify-content: space-between; }
        .btn-sm { margin-left: 5px; }
    </style>
</head>
<body>

<div class="container-fluid h-100">
    <div class="row h-100">
        <div class="col-md-3 left-side">
            <nav class="nav flex-column">
                <a class="nav-link" href="home.html">Home</a>
                <a class="nav-link" href="myday.html">My Day</a>
                <a class="nav-link active" href="important.html">Important</a>
                <a class="nav-link" href="planned.html">Planned</a>
                <a class="nav-link" href="task.html">Tasks</a>
            </nav>
        </div>
        <div class="col-md-9 right-side">
            <h2>Tasks</h2>
            <input type="text" id="taskInput" class="form-control" placeholder="Add new task...">
            <input type="date" id="taskDueDate" class="form-control mt-2" placeholder="Due date (optional)">
            <button id="addTaskBtn" class="btn btn-primary mt-2">Add Task</button>
            <ul id="taskList" class="list-group mt-3"></ul>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('addTaskBtn').addEventListener('click', addTask);
    displayTasks(); // Display tasks on initial load
});

function addTask() {
    var taskInput = document.getElementById('taskInput');
    var dueDateInput = document.getElementById('taskDueDate');
    var taskName = taskInput.value.trim();
    var dueDate = dueDateInput.value; // This can be an empty string if no date is selected

    if (taskName) { // Task name is required
        var allTasks = JSON.parse(localStorage.getItem('allTasks')) || [];
        
        if (!allTasks.some(task => task.taskName === taskName)) {
            var newTask = {
                taskName,
                dueDate: dueDate || "" // Store an empty string if no due date is provided
            };
            allTasks.push(newTask);
            localStorage.setItem('allTasks', JSON.stringify(allTasks));
            displayTasks();
        } else {
            alert('Task already exists.');
        }

        taskInput.value = ''; // Clear the task input field after adding
        dueDateInput.value = ''; // Clear the due date input field
    } else {
        alert('Please enter a task name.');
    }
}

function displayTasks() {
    var allTasks = JSON.parse(localStorage.getItem('allTasks')) || [];
    var importantTasks = JSON.parse(localStorage.getItem('importantTasks')) || [];
    var taskListElement = document.getElementById('taskList');
    taskListElement.innerHTML = ''; // Clear the list for updated display

    allTasks.forEach(function(taskObj) {
        var li = document.createElement('li');
        li.classList.add('list-group-item', 'task-item');

        // Initialize the star button for marking importance
        var starBtn = document.createElement('button');
        starBtn.className = 'btn btn-sm mr-2'; // Added margin-right for spacing
        starBtn.innerHTML = importantTasks.includes(taskObj.taskName) ? '&#9733;' : '&#9734;';
        starBtn.style.color = importantTasks.includes(taskObj.taskName) ? 'yellow' : 'gray';
        starBtn.style.fontSize = '20px'; // Enlarge the star for better visibility
        starBtn.onclick = function() {
            toggleImportance(taskObj.taskName);
        };

        var taskSpan = document.createElement('span');
        taskSpan.textContent = taskObj.taskName + (taskObj.dueDate ? ` (Due: ${taskObj.dueDate})` : '');

        // Initialize the delete button with "X"
        var deleteBtn = document.createElement('button');
        deleteBtn.innerHTML = '&times;';
        deleteBtn.className = 'btn btn-danger btn-sm ml-auto'; // Use ml-auto to push it to the far right
        deleteBtn.onclick = function() {
            deleteTask(taskObj.taskName);
        };

        // Append elements in the order of star (importance), text, and then delete ("X")
        li.appendChild(starBtn); // Star button immediately next to the task name on the left
        li.appendChild(taskSpan);
        li.appendChild(deleteBtn); // Ensure the delete button is on the right side
        
        taskListElement.appendChild(li);
    });
}




function toggleImportance(taskName) {
    var importantTasks = JSON.parse(localStorage.getItem('importantTasks')) || [];
    var index = importantTasks.indexOf(taskName);
    if (index === -1) {
        importantTasks.push(taskName);
    } else {
        importantTasks.splice(index, 1);
    }
    localStorage.setItem('importantTasks', JSON.stringify(importantTasks));
    displayTasks(); // Refresh the task list to update star colors
}

function deleteTask(taskName) {

    var allTasks = JSON.parse(localStorage.getItem('allTasks')) || [];
    var importantTasks = JSON.parse(localStorage.getItem('importantTasks')) || [];
    // Filter out the task to be deleted
    allTasks = allTasks.filter(task => task.taskName !== taskName);
    importantTasks = importantTasks.filter(task => task !== taskName); // Also remove from important if present

    localStorage.setItem('allTasks', JSON.stringify(allTasks));
    localStorage.setItem('importantTasks', JSON.stringify(importantTasks));

    displayTasks(); // Refresh the displayed list
}

</script>
</body>
</html>

